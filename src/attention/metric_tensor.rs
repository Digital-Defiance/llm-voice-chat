//! To be implemented with CUDA kernels